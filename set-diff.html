<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›†åˆå·®é›† / äº¤é›† - IT å·¥å…·é›†</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .back-link {
            color: #a78bfa;
            text-decoration: none;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .back-link:hover { opacity: 1; }

        h1 {
            font-size: 1.8rem;
            font-weight: 400;
            color: #a78bfa;
        }

        .options-bar {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .option-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-group label {
            color: #888;
            font-size: 0.9rem;
        }

        select {
            padding: 10px 14px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: #fff;
            font-size: 0.95rem;
        }

        select:focus {
            outline: none;
            border-color: #a78bfa;
        }

        .option-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #a78bfa;
        }

        .hint {
            color: #666;
            font-size: 0.85rem;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1000px) {
            .editor-container { grid-template-columns: 1fr; }
            .options-bar { flex-direction: column; align-items: flex-start; }
        }

        .editor-panel {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .panel-header {
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-header h3 {
            font-weight: 400;
            font-size: 1rem;
            color: #aaa;
        }

        .line-count {
            font-size: 0.85rem;
            color: #a78bfa;
            background: rgba(167, 139, 250, 0.12);
            padding: 4px 12px;
            border-radius: 20px;
            white-space: nowrap;
        }

        textarea {
            width: 100%;
            height: 420px;
            background: transparent;
            border: none;
            padding: 20px;
            color: #e0e0e0;
            font-family: 'Consolas', 'Monaco', 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
        }

        textarea:focus { outline: none; }
        textarea::placeholder { color: #555; }

        #output {
            color: #a78bfa;
        }

        .toolbar {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #a78bfa, #8b5cf6);
            color: #0f0c29;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(167, 139, 250, 0.25);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #a78bfa;
            color: #0f0c29;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 500;
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">â† è¿”å›å·¥å…·é›†</a>
            <h1>ğŸ§® é›†åˆå·®é›† / äº¤é›†</h1>
            <div style="width: 100px;"></div>
        </header>

        <div class="options-bar">
            <div class="option-group">
                <label for="mode">æ¨¡å¼</label>
                <select id="mode">
                    <option value="diff">å·®é›†ï¼šA \ B</option>
                    <option value="intersect">äº¤é›†ï¼šA âˆ© B</option>
                </select>
            </div>
            <div class="option-group">
                <label for="dedupe">å»é‡</label>
                <input id="dedupe" type="checkbox" checked>
                <span class="hint">å‚ä¸è®¡ç®—ä¸è¾“å‡ºå‡å»é‡ï¼ˆä¿æŒ A çš„é¡ºåºï¼‰</span>
            </div>
            <div class="option-group">
                <label for="ignoreCase">å¿½ç•¥å¤§å°å†™</label>
                <input id="ignoreCase" type="checkbox">
                <span class="hint">æ¯”è¾ƒæ—¶ä¸åŒºåˆ†å¤§å°å†™ï¼Œè¾“å‡ºä»ä¿ç•™ A åŸå€¼</span>
            </div>
        </div>

        <div class="editor-container">
            <div class="editor-panel">
                <div class="panel-header">
                    <h3>è¾“å…¥ Aï¼ˆæ¯è¡Œä¸€ä¸ªå€¼ï¼‰</h3>
                    <span class="line-count" id="aCount">0 è¡Œ</span>
                </div>
                <textarea id="inputA" placeholder="ç²˜è´´ A åˆ—è¡¨ï¼Œä¾‹å¦‚ï¼š&#10;user001&#10;user002&#10;user003"></textarea>
            </div>

            <div class="editor-panel">
                <div class="panel-header">
                    <h3>è¾“å…¥ Bï¼ˆæ¯è¡Œä¸€ä¸ªå€¼ï¼‰</h3>
                    <span class="line-count" id="bCount">0 è¡Œ</span>
                </div>
                <textarea id="inputB" placeholder="ç²˜è´´ B åˆ—è¡¨ï¼Œä¾‹å¦‚ï¼š&#10;user002&#10;user004"></textarea>
            </div>

            <div class="editor-panel">
                <div class="panel-header">
                    <h3 id="outputTitle">è¾“å‡º A \ B</h3>
                    <span class="line-count" id="outMeta">0 è¡Œ / 0 å­—ç¬¦</span>
                </div>
                <textarea id="output" readonly placeholder="ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            </div>
        </div>

        <div class="toolbar">
            <button id="computeBtn" class="btn-primary" type="button" onclick="compute()">è®¡ç®—å·®é›†</button>
            <button class="btn-secondary" type="button" onclick="copyOutput()">å¤åˆ¶ç»“æœ</button>
            <button class="btn-secondary" type="button" onclick="clearAll()">æ¸…ç©º</button>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        const inputA = document.getElementById('inputA');
        const inputB = document.getElementById('inputB');
        const output = document.getElementById('output');
        const aCount = document.getElementById('aCount');
        const bCount = document.getElementById('bCount');
        const outMeta = document.getElementById('outMeta');
        const outputTitle = document.getElementById('outputTitle');
        const computeBtn = document.getElementById('computeBtn');
        const mode = document.getElementById('mode');
        const dedupe = document.getElementById('dedupe');
        const ignoreCase = document.getElementById('ignoreCase');

        function getLines(value) {
            return value
                .split(/\r?\n/)
                .map(s => s.trim())
                .filter(s => s.length > 0);
        }

        function normalize(value) {
            return ignoreCase.checked ? value.toLowerCase() : value;
        }

        function updateInputCounts() {
            aCount.textContent = getLines(inputA.value).length + ' è¡Œ';
            bCount.textContent = getLines(inputB.value).length + ' è¡Œ';
        }

        inputA.addEventListener('input', updateInputCounts);
        inputB.addEventListener('input', updateInputCounts);

        function getModeMeta() {
            if (mode.value === 'intersect') {
                return { title: 'è¾“å‡º A âˆ© B', button: 'è®¡ç®—äº¤é›†' };
            }
            return { title: 'è¾“å‡º A \\ B', button: 'è®¡ç®—å·®é›†' };
        }

        function applyModeMeta() {
            const meta = getModeMeta();
            outputTitle.textContent = meta.title;
            computeBtn.textContent = meta.button;
        }

        mode.addEventListener('change', () => {
            applyModeMeta();
            // å¦‚æœ A å·²æœ‰å†…å®¹ï¼Œåˆ‡æ¢æ¨¡å¼åç›´æ¥åˆ·æ–°ç»“æœï¼Œé¿å…ç”¨æˆ·è¯¯ä»¥ä¸ºæœªç”Ÿæ•ˆ
            if (getLines(inputA.value).length > 0) compute();
        });

        function compute() {
            const aLines = getLines(inputA.value);
            const bLines = getLines(inputB.value);

            if (aLines.length === 0) {
                showToast('è¯·è¾“å…¥ A æ•°æ®');
                return;
            }

            const bSet = new Set(bLines.map(normalize));
            const result = [];

            const seen = new Set();
            for (const raw of aLines) {
                const key = normalize(raw);
                if (mode.value === 'intersect') {
                    if (!bSet.has(key)) continue;
                } else {
                    if (bSet.has(key)) continue;
                }

                if (dedupe.checked) {
                    if (seen.has(key)) continue;
                    seen.add(key);
                }

                result.push(raw);
            }

            output.value = result.join('\n');
            outMeta.textContent = `${result.length} è¡Œ / ${output.value.length} å­—ç¬¦`;
        }

        function copyOutput() {
            if (!output.value) {
                showToast('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
                return;
            }

            navigator.clipboard.writeText(output.value).then(() => {
                showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }).catch(() => {
                output.select();
                document.execCommand('copy');
                showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        }

        function clearAll() {
            inputA.value = '';
            inputB.value = '';
            output.value = '';
            aCount.textContent = '0 è¡Œ';
            bCount.textContent = '0 è¡Œ';
            outMeta.textContent = '0 è¡Œ / 0 å­—ç¬¦';
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // å¿«æ·é”®ï¼šCtrl/Cmd + Enter è®¡ç®—å·®é›†
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    compute();
                }
            }
        });

        // åˆå§‹åŒ–
        applyModeMeta();
    </script>
</body>
</html>

